<!doctype html>
<head>
	<title>Ball Module: Test Suite</title>	
	<link rel="stylesheet" href="http://code.jquery.com/qunit/qunit-git.css" type="text/css" media="screen">

	<script src="http://code.jquery.com/qunit/qunit-git.js"></script>
	<script src="../libs/sinon-1.3.2.js"></script>
	<script src="../libs/require-jquery.js"></script>
	<script src="./resources/testing.js"></script>
	<script>
		QUnit.config.testTimeout = 2000;

		test( 'not running tests under the "file:" protocol', function(){
			notStrictEqual( window.location.protocol, 'file:' );
		});

		module( 'New Ball', {
			setup: function(){
				testing.setupAndTeardown.setup();
				//testing.sandbox.useFakeTimers();
			},
			teardown: function(){
				strictEqual( $( '#qunit-fixture' ).find( 'div' ).text(), '1', 'ball markup was added to the page' );
				testing.setupAndTeardown.teardown();
			}
		});

		test( 'able to create new instance of Ball', function(){
			testing.req.given( 'js/mods/ball', function ( Ball ) {
				var b = new Ball( 1000, '#qunit-fixture' );

				ok( b instanceof Ball );
				ok( b.$ball.jquery );
				strictEqual( b.speed, 1000 );
				equal( typeof b.width, 'number' );
				equal( typeof b.height, 'number' );
			});
		});

		test( 'ball instance can start', function(){
			testing.req.given( 'js/mods/ball', function ( Ball ) {
				var b = new Ball( 1000, '#qunit-fixture' ),
					duration = 500;

				testing.sandbox.useFakeTimers();

				b.start();
				ok( b.$ball.is( ':animated' ) );
				ok( ! b.isPaused );
				ok( ! b.$ball.hasClass( 'is-paused' ) );
				b.stop();
				testing.sandbox.clock.tick( duration * 2 );
			});
		});

		test( 'ball instance can stop', function(){
			testing.req.given( 'js/mods/ball', function ( Ball ) {
				var b = new Ball( 1000, '#qunit-fixture' ),
					duration = 500;

				testing.sandbox.useFakeTimers();

				b.start();
				testing.sandbox.clock.tick( duration / 2 );
				b.stop();
				testing.sandbox.clock.tick( duration * 2 );

				ok( ! b.$ball.is( ':animated' ) );
				ok( b.isPaused );
				ok( b.$ball.hasClass( 'is-paused' ) );
			});
		});

		test( 'ball instance can move', function(){
			testing.req.given( 'js/mods/ball', function ( Ball ) {
				var b = new Ball( 1000, '#qunit-fixture' ),
					duration = 500;

				testing.sandbox.useFakeTimers();

				b.move();
				ok( b.$ball.is( ':animated' ) );
				ok( ! b.$ball.hasClass( 'is-paused' ) );
				b.stop();
				testing.sandbox.clock.tick( duration * 2 );
			});
		});
	</script>
</head>
<body>
	<h1 id="qunit-header">Ball Module: Test Suite</h1>
	<h2 id="qunit-banner"></h2>
	<div id="qunit-testrunner-toolbar"></div>
	<h2 id="qunit-userAgent"></h2>
	<ol id="qunit-tests"></ol>
	<div id="qunit-fixture">
	</div>
</body>
</html>
